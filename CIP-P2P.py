from scapy.all import *
from ipaddress import IPv4Address


class CIP_P2P:

    afghanistan_ip_ranges = {
        ('36.50.21.0', '36.50.21.255'), ('103.151.88.0',
                                         '103.151.88.255'), ('82.205.138.0', '82.205.138.255'),
        ('103.86.124.0', '103.86.127.255'), ('103.165.190.0',
                                             '103.165.191.255'), ('103.104.146.0', '103.104.147.255'),
        ('103.112.164.0', '103.112.167.255'), ('149.54.0.0',
                                               '149.54.127.255'), ('45.126.253.0', '45.126.253.255'),
        ('156.229.32.0', '156.229.39.255'), ('103.177.206.0',
                                             '103.177.207.255'), ('103.94.24.0', '103.94.25.255'),
        ('121.100.48.0', '121.100.55.255'), ('91.109.216.0',
                                             '91.109.223.255'), ('103.42.0.0', '103.42.3.255'),
        ('152.36.192.0', '152.36.223.255'), ('103.116.25.0',
                                             '103.116.25.255'), ('80.247.139.0', '80.247.139.255'),
        ('103.46.208.0', '103.46.211.255'), ('103.215.210.0',
                                             '103.215.211.255'), ('61.5.192.0', '61.5.207.255'),
        ('180.222.136.0', '180.222.143.255'), ('103.5.172.0',
                                               '103.5.175.255'), ('103.13.64.0', '103.13.67.255'),
        ('103.159.163.0', '103.159.163.255'), ('103.93.254.0',
                                               '103.93.254.255'), ('82.205.196.0', '82.205.199.255'),
        ('116.204.240.0', '116.204.243.255'), ('196.195.15.0',
                                               '196.195.15.255'), ('103.213.104.0', '103.213.107.255'),
        ('210.89.71.0', '210.89.71.255'), ('217.10.167.0',
                                           '217.10.167.255'), ('103.28.132.0', '103.28.135.255'),
        ('103.96.233.0', '103.96.233.255'), ('175.176.235.0',
                                             '175.176.243.255'), ('103.71.59.0', '103.71.59.255'),
        ('119.59.80.0', '119.59.87.255'), ('202.3.76.0',
                                           '202.3.76.255'), ('180.94.64.0', '180.94.95.255'),
        ('103.87.88.0', '103.87.88.255'), ('203.171.96.0',
                                           '203.171.127.255'), ('185.193.212.0', '185.193.215.255'),
        ('116.206.188.0', '116.206.191.255'), ('121.127.32.0',
                                               '121.127.32.255'), ('185.112.128.0', '185.112.129.255'),
        ('103.147.232.0', '103.147.233.255'), ('103.112.177.0',
                                               '103.112.179.255'), ('103.15.238.0', '103.15.239.255'),
        ('103.88.192.0', '103.88.195.255'), ('113.208.72.0',
                                             '113.208.73.255'), ('103.227.16.0', '103.227.19.255'),
        ('125.253.152.0', '125.253.157.255'), ('103.115.14.0',
                                               '103.115.15.255'), ('103.161.236.0', '103.161.237.255'),
        ('103.212.160.0', '103.212.161.255'), ('103.149.39.0',
                                               '103.149.39.255'), ('157.240.159.0', '157.240.159.255'),
        ('82.205.181.0', '82.205.181.255'), ('103.162.126.0',
                                             '103.162.126.255'), ('103.53.16.0', '103.53.19.255'),
        ('103.89.152.0', '103.89.153.255'), ('103.242.50.0',
                                             '103.242.51.255'), ('103.185.231.0', '103.185.231.255'),
        ('82.205.151.0', '82.205.151.255'), ('185.178.144.0',
                                             '185.178.147.255'), ('103.146.104.0', '103.146.104.255'),
        ('59.153.124.0', '59.153.127.255'), ('125.253.164.0',
                                             '125.253.166.255'), ('203.215.32.0', '203.215.47.255'),
        ('103.119.24.0', '103.119.27.255'), ('103.216.160.0',
                                             '103.216.160.255'), ('111.125.152.0', '111.125.159.255'),
        ('82.205.202.0', '82.205.207.255'), ('64.224.144.0',
                                             '64.224.159.255'), ('103.17.165.0', '103.17.167.255'),
        ('103.224.127.0', '103.224.127.255'), ('223.26.20.0',
                                               '223.26.23.255'), ('103.15.38.0', '103.15.38.255'),
        ('103.153.80.0', '103.153.80.255'), ('103.230.252.0',
                                             '103.230.255.255'), ('103.148.70.0', '103.148.71.255'),
        ('185.27.250.0', '185.27.250.255'), ('103.53.24.0',
                                             '103.53.27.255'), ('103.142.212.0', '103.142.213.255'),
        ('175.106.32.0', '175.106.63.255'), ('103.132.98.0',
                                             '103.132.99.255'), ('117.104.224.0', '117.104.231.255'),
        ('103.146.146.0', '103.146.146.255'), ('116.204.160.0',
                                               '116.204.163.255'), ('163.47.160.0', '163.47.163.255'),
        ('157.10.229.0', '157.10.229.255'), ('103.18.160.0',
                                             '103.18.163.255'), ('103.143.204.0', '103.143.205.255'),
        ('203.174.27.0', '203.174.27.255'), ('103.126.4.0',
                                             '103.126.5.255'), ('23.88.192.0', '23.88.223.255'),
        ('103.255.204.0', '103.255.205.255'), ('103.235.176.0',
                                               '103.235.179.255'), ('103.254.166.0', '103.254.166.255'),
        ('103.157.85.0', '103.157.85.255'), ('103.244.146.0',
                                             '103.244.147.255'), ('196.195.4.0', '196.195.4.255'),
        ('74.118.80.0', '74.118.83.255'), ('121.127.37.0',
                                           '121.127.38.255'), ('103.102.220.0', '103.102.221.255'),
        ('103.30.136.0', '103.30.139.255'), ('43.230.209.0',
                                             '43.230.209.255'), ('128.41.128.0', '128.41.255.255'),
        ('103.17.60.0', '103.17.63.255'), ('43.250.136.0',
                                           '43.250.139.255'), ('210.89.87.0', '210.89.87.255'),
        ('103.125.186.0', '103.125.186.255'), ('103.146.198.0',
                                               '103.146.198.255'), ('117.55.192.0', '117.55.198.255'),
        ('210.89.73.0', '210.89.76.255'), ('103.133.75.0',
                                           '103.133.75.255'), ('203.88.92.0', '203.88.92.255'),
        ('185.27.248.0', '185.27.248.255'), ('103.84.97.0',
                                             '103.84.97.255'), ('64.207.208.0', '64.207.215.255'),
        ('103.106.182.0', '103.106.182.255'), ('121.127.34.0',
                                               '121.127.34.255'), ('103.110.53.0', '103.110.55.255'),
        ('45.65.56.0', '45.65.59.255'), ('103.156.190.0',
                                         '103.156.191.255'), ('103.170.98.0', '103.170.99.255'),
        ('103.114.128.0', '103.114.129.255'), ('103.247.198.0',
                                               '103.247.198.255'), ('202.174.157.0', '202.174.157.255'),
        ('103.241.156.0', '103.241.159.255'), ('103.133.82.0',
                                               '103.133.83.255'), ('210.89.78.0', '210.89.80.255'),
        ('58.147.128.0', '58.147.159.255'), ('103.233.183.0',
                                             '103.233.183.255'), ('125.213.192.0', '125.213.223.255'),
        ('137.59.120.0', '137.59.123.255'), ('196.195.253.0',
                                             '196.195.253.255'), ('103.144.237.0', '103.144.237.255'),
        ('103.23.36.0', '103.23.39.255'), ('103.168.193.0',
                                           '103.168.193.255'), ('45.116.128.0', '45.116.129.255'),
        ('192.168.0.0', '192.168.255.255')}

    def analyze_packet(packet):
        if IP in packet:
            source_ip = IPv4Address(packet[IP].src)

            if any(IPv4Address(ip_range[0]) <= source_ip <= IPv4Address(ip_range[1]) for ip_range in afghanistan_ip_ranges):
                print(f"Allowed packet from {source_ip}")
            else:
                print(f"Blocked packet from {source_ip}")
